const starData = [
    {
        id: "1 Star",
        levels: [
            {
                title: "Cloud",
                passing: "0.5",
                perfect: "0.5"
            },
            {
                title: "Sunny",
                passing: "0.6",
                perfect: "0.7"
            },
            {
                title: "Hoop Dream",
                passing: "0.7",
                perfect: "0.8"
            },
            {
                title: "Tropical Tides",
                passing: "0.7",
                perfect: "0.8"
            },
            {
                title: "Massif",
                passing: "0.7",
                perfect: "0.9"
            },
            {
                title: "The Winter",
                passing: "0.8",
                perfect: "1.1"
            },
            {
                title: "illusion",
                passing: "0.8",
                perfect: "1.2"
            },
            {
                title: "Starfield",
                passing: "0.8",
                perfect: "0.9"
            },
            {
                title: "Tsunami",
                passing: "0.8",
                perfect: "1.0"
            },
            {
                title: "Sweet Paradise",
                passing: "1.3",
                perfect: "1.4"
            },
            {
                title: "Clown Park",
                passing: "0.6",
                perfect: "2.3"
            },
            {
                title: "Jack-O'-Lantern",
                passing: "1.4",
                perfect: "2.5"
            },
            {
                title: "Skeleton Party",
                passing: "1.4",
                perfect: "1.8"
            },
            {
                title: "Venus",
                passing: "1.5",
                perfect: "2.1"
            },
            {
                title: "The Eye of Horus",
                passing: "1.3",
                perfect: "2.3"
            },
            {
                title: "Cobweb",
                passing: "1.3",
                perfect: "2.6"
            },
            {
                title: "8Bits",
                passing: "1.4",
                perfect: "4.2"
            }
        ]
    },
    {
        id: "2 Star",
        levels: [
            {
                title: "Sky",
                passing: "2.2",
                perfect: "2.5"
            },
            {
                title: "Halloween Escape",
                passing: "2.0",
                perfect: "3.6"
            },
            {
                title: "Fairy Tale",
                passing: "2.3",
                perfect: "3.3"
            },
            {
                title: "Mental Rave",
                passing: "2.3",
                perfect: "3.4"
            },
            {
                title: "Snowy Night",
                passing: "2.1",
                perfect: "3.8"
            },
            {
                title: "Temple Fair",
                passing: "2.5",
                perfect: "3.9"
            },
            {
                title: "JOKER",
                passing: "2.5",
                perfect: "3.8"
            },
            {
                title: "Laser",
                passing: "2.5",
                perfect: "3.8"
            },
            {
                title: "Faster",
                passing: "1.5",
                perfect: "3.2"
            },
            {
                title: "Golden Christmas",
                passing: "2.5",
                perfect: "4.4"
            },
            {
                title: "Dazzle",
                passing: "2.7",
                perfect: "4.6"
            },
            {
                title: "Falling Blossoms",
                passing: "2.2",
                perfect: "4.7"
            },
            {
                title: "Star",
                passing: "2.8",
                perfect: "4.2"
            },
            {
                title: "Eternal Journey",
                passing: "2.9",
                perfect: "4.1"
            },
            {
                title: "Mysterious Trail",
                passing: "2.9",
                perfect: "3.5"
            },
            {
                title: "Football Field",
                passing: "3.0",
                perfect: "4.5"
            },
            {
                title: "Alone Remix*",
                passing: "2.8",
                perfect: "3.2"
            }
        ]
    },
    {
        id: "3 Star",
        levels: [
            {
                title: "Monody",
                passing: "3.1",
                perfect: "4.4"
            },
            {
                title: "Sea World",
                passing: "3.1",
                perfect: "4.7"
            },
            {
                title: "Gemini",
                passing: "3.5",
                perfect: "4.2"
            },
            {
                title: "The Shadow Warrior",
                passing: "3.2",
                perfect: "3.8"
            },
            {
                title: "Forest",
                passing: "3.3",
                perfect: "4.0"
            },
            {
                title: "Candy",
                passing: "3.2",
                perfect: "5.1"
            },
            {
                title: "Crisscross",
                passing: "3.5",
                perfect: "4.5"
            },
            {
                title: "Desert",
                passing: "3.8",
                perfect: "4.3"
            },
            {
                title: "Otherworld",
                passing: "3.4",
                perfect: "5.3"
            },
            {
                title: "Storms & Love",
                passing: "4.3",
                perfect: "5.0"
            },
            {
                title: "Fireworks",
                passing: "3.7",
                perfect: "4.1"
            },
            {
                title: "Championship",
                passing: "3.8",
                perfect: "4.5"
            },
            {
                title: "Ghost Dance",
                passing: "3.6",
                perfect: "3.8"
            },
            {
                title: "Dynamic Cube",
                passing: "3.8",
                perfect: "5.2"
            },
            {
                title: "Kung Fu",
                passing: "3.5",
                perfect: "5.3"
            },
            {
                title: "Matrix",
                passing: "3.8",
                perfect: "5.2"
            },
            {
                title: "Fantastic Sweet House",
                passing: "3.7",
                perfect: "5.4"
            },
            {
                title: "Trick or Treat",
                passing: "3.9",
                perfect: "4.7"
            },
            {
                title: "Tactic Core",
                passing: "3.9",
                perfect: "5.0"
            },
            {
                title: "Anniversary",
                passing: "3.3",
                perfect: "5.2"
            },
            {
                title: "Faded*",
                passing: "3.4",
                perfect: "3.9"
            },
            {
                title: "Faded Remix*",
                passing: "3.7",
                perfect: "4.5"
            },
            {
                title: "Alone*",
                passing: "3.8",
                perfect: "4.7"
            },
            {
                title: "Forest* (Removed Ver.)",
                passing: "3.3",
                perfect: "3.8"
            }
        ]
    },
    {
        id: "4 Star",
        levels: [
            {
                title: "Pirate Ship",
                passing: "3.8",
                perfect: "5.2"
            },
            {
                title: "Unlock the Future",
                passing: "4.1",
                perfect: "4.9"
            },
            {
                title: "Delicacy Temptation",
                passing: "4.0",
                perfect: "5.0"
            },
            {
                title: "Aurora Tour",
                passing: "4.2",
                perfect: "5.2"
            },
            {
                title: "Christmas Gospel",
                passing: "4.1",
                perfect: "4.8"
            },
            {
                title: "Volcano",
                passing: "4.2",
                perfect: "4.5"
            },
            {
                title: "Goblin Town",
                passing: "4.3",
                perfect: "5.2"
            },
            {
                title: "Digital Matrix",
                passing: "4.3",
                perfect: "5.4"
            },
            {
                title: "Circus",
                passing: "4.5",
                perfect: "5.1"
            },
            {
                title: "City",
                passing: "4.6",
                perfect: "4.9"
            },
            {
                title: "Interstellar Leap",
                passing: "4.3",
                perfect: "5.7"
            },
            {
                title: "Monster Chorus",
                passing: "4.5",
                perfect: "5.0"
            },
            {
                title: "Lost City",
                passing: "4.6",
                perfect: "4.8"
            },
            {
                title: "Naval Battle",
                passing: "4.6",
                perfect: "5.2"
            },
            {
                title: "VR Fairyland",
                passing: "4.5",
                perfect: "5.5"
            },
            {
                title: "Sci-Tech",
                passing: "4.7",
                perfect: "5.0"
            },
            {
                title: "Tetris",
                passing: "4.8",
                perfect: "5.1"
            },
            {
                title: "The Day of the Dead",
                passing: "4.7",
                perfect: "5.3"
            },
            {
                title: "Relics",
                passing: "4.9",
                perfect: "5.3"
            },
            {
                title: "Birthday Party",
                passing: "4.8",
                perfect: "5.4"
            },
            {
                title: "Reggae",
                passing: "4.8",
                perfect: "5.3"
            },
            {
                title: "Morning Dawn",
                passing: "4.9",
                perfect: "5.8"
            },
            {
                title: "Monster City",
                passing: "4.9",
                perfect: "5.6"
            },
            {
                title: "Dino Disco",
                passing: "5.0",
                perfect: "5.8"
            },
            {
                title: "Alone II*",
                passing: "4.9",
                perfect: "5.3"
            },
            {
                title: "The Spectre*",
                passing: "5.2",
                perfect: "5.4"
            },
            {
                title: "Ignite*",
                passing: "4.3",
                perfect: "5.2"
            }
        ]
    },
    {
        id: "5 Star",
        levels: [
            {
                title: "Varying Christmas",
                passing: "5.0",
                perfect: "5.3"
            },
            {
                title: "Street Basketball",
                passing: "5.1",
                perfect: "5.4"
            },
            {
                title: "Sunset Glow",
                passing: "5.0 or 5.2",
                perfect: "6.0 or 6.1"
            },
            {
                title: "Mecha",
                passing: "5.1",
                perfect: "5.4"
            },
            {
                title: "Egypt",
                passing: "5.2",
                perfect: "5.7"
            },
            {
                title: "Rhythm Party",
                passing: "5.2",
                perfect: "5.7"
            },
            {
                title: "Chess Fortress",
                passing: "5.2",
                perfect: "5.9"
            },
            {
                title: "Castle in the Sky",
                passing: "5.5",
                perfect: "5.6"
            },
            {
                title: "Halloween",
                passing: "5.5",
                perfect: "5.7"
            },
            {
                title: "Flower Dance",
                passing: "5.4",
                perfect: "6.0"
            },
            {
                title: "Mechanical Power",
                passing: "5.4",
                perfect: "6.1"
            },
            {
                title: "Kepler’s Dream",
                passing: "5.2",
                perfect: "6.1"
            },
            {
                title: "Spring Festival",
                passing: "5.5",
                perfect: "5.8"
            },
            {
                title: "Microchip",
                passing: "5.6",
                perfect: "5.9"
            },
            {
                title: "Horizon Cruise",
                passing: "5.4",
                perfect: "6.1"
            },
            {
                title: "The Sea",
                passing: "5.6",
                perfect: "6.1"
            },
            {
                title: "E-labyrinth",
                passing: "5.7",
                perfect: "5.9"
            },
            {
                title: "Deep Space",
                passing: "5.6",
                perfect: "5.8"
            },
            {
                title: "Poker",
                passing: "5.3",
                perfect: "6.5"
            },
            {
                title: "Reindeers’ Gift",
                passing: "5.4",
                perfect: "6.5"
            },
            {
                title: "Midnight Carnival",
                passing: "5.6",
                perfect: "6.0"
            },
            {
                title: "Christmas",
                passing: "5.8",
                perfect: "6.1"
            },
            {
                title: "Ghost Samurai",
                passing: "5.6",
                perfect: "6.2"
            },
            {
                title: "Neon",
                passing: "5.5",
                perfect: "6.1"
            },
            {
                title: "American Football",
                passing: "5.7",
                perfect: "5.9"
            },
            {
                title: "Steam Era",
                passing: "5.7",
                perfect: "6.3"
            },
            {
                title: "Psychedelic Music",
                passing: "5.7",
                perfect: "6.2"
            },
            {
                title: "Dinosaur Valley",
                passing: "5.8",
                perfect: "6.3"
            },
            {
                title: "Competition Park",
                passing: "5.8",
                perfect: "6.3"
            },
            {
                title: "Happy",
                passing: "6.0",
                perfect: "6.4"
            },
            {
                title: "World Cup",
                passing: "5.9",
                perfect: "6.1"
            },
            {
                title: "1UP",
                passing: "5.9",
                perfect: "6.3"
            },
            {
                title: "Cube",
                passing: "4.6",
                perfect: "6.7"
            },
            {
                title: "The Spectre Remix*",
                passing: "5.7",
                perfect: "5.9"
            }
        ]
    },
    {
        id: "6 Star",
        levels: [
            {
                title: "New Year",
                passing: "6.0",
                perfect: "6.3 or 6.4"
            },
            {
                title: "Halloween Night",
                passing: "6.0",
                perfect: "6.3"
            },
            {
                title: "Lov-E",
                passing: "6.4",
                perfect: "6.7"
            },
            {
                title: "Happy Birthday",
                passing: "6.2",
                perfect: "6.4"
            },
            {
                title: "Auspicious Jade Rabbit",
                passing: "6.3",
                perfect: "6.7 or 6.8"
            },
            {
                title: "The 4th Anniversary",
                passing: "6.4",
                perfect: "6.8"
            }
        ]
    }
];

const resultDiv = document.getElementById("result");
const stars = document.querySelectorAll(".stars button");
const sortDropdown = document.getElementById("sort-dropdown");
const moveLevelsCheckbox = document.getElementById("move-levels");
let selectedSort = "default";
let moveLevels = false;

// Function to create level item
function createLevelItem(levelData) {
  const levelDiv = document.createElement("div");
  levelDiv.classList.add("level");

  const image = document.createElement("img");
  image.src = `thumbnails/${levelData.title}.png`;
  image.alt = levelData.title;
  levelDiv.appendChild(image);

  const contentDiv = document.createElement("div");
  contentDiv.classList.add("content");

  const titleSpan = document.createElement("span");
  titleSpan.textContent = levelData.title;
  titleSpan.style.fontWeight = "bold";
  contentDiv.appendChild(titleSpan);

  const passingSpan = document.createElement("span");
  passingSpan.textContent = `Passing: ${levelData.passing}`;
  passingSpan.classList.add("passing");
  contentDiv.appendChild(passingSpan);

  const perfectSpan = document.createElement("span");
  perfectSpan.textContent = `Perfect: ${levelData.perfect}`;
  perfectSpan.classList.add("perfect");
  contentDiv.appendChild(perfectSpan);

  const average = (parseFloat(levelData.passing) + parseFloat(levelData.perfect)) / 2;
  const averageSpan = document.createElement("span");
  averageSpan.textContent = `Average: ${average.toFixed(2)}`;
  averageSpan.classList.add("average");
  contentDiv.appendChild(averageSpan);

  levelDiv.appendChild(contentDiv);

  return levelDiv;
}

// Event listener for move levels checkbox change
moveLevelsCheckbox.addEventListener("change", (event) => {
  moveLevels = event.target.checked;
  const activeStar = document.querySelector(".stars button.active");
  const selectedStar = starData.find((star) => star.id === activeStar.id);
  sortLevels(selectedStar);
});

// Function to sort levels
function sortLevels(star) {
  const selectedStar = star;
  let sortedLevels = [];

  const selectedSortFunction = {
    default: () => selectedStar.levels,
    passing: () => selectedStar.levels.filter(level => parseInt(level.passing[0]) >= parseInt(selectedStar.id[0])),
    perfect: () => selectedStar.levels.filter(level => {
      const levelRange = parseInt(level.perfect[0]);
      const starRange = parseInt(selectedStar.id[0]);
      return levelRange <= starRange;
    }),
    average: () => selectedStar.levels.filter(level => {
      const average = (parseFloat(level.passing) + parseFloat(level.perfect)) / 2;
      return parseInt(average.toString()[0]) >= parseInt(selectedStar.id[0]);
    })
  };

  if (moveLevels) {
    sortedLevels = selectedSortFunction[selectedSort]();

    // Move levels from other stars if the checkbox is checked
    const currentSort = selectedSort === "default" ? "passing" : selectedSort;
    const starRange = parseInt(selectedStar.id[0]);
    for (const otherStar of starData) {
      if (otherStar.id !== selectedStar.id) {
        const otherLevels = otherStar.levels.filter((level) => {
          const levelValue = parseFloat(level[currentSort]);
          const levelRange = parseInt(levelValue.toString()[0]);
          return levelRange === starRange;
        });
        sortedLevels = sortedLevels.concat(otherLevels);
      }
    }
  } else {
    sortedLevels = selectedStar.levels;
  }

  sortedLevels.sort((a, b) => {
    const sortFunction = {
      passing: (a, b) => parseFloat(a.passing) - parseFloat(b.passing),
      perfect: (a, b) => parseFloat(a.perfect) - parseFloat(b.perfect),
      default: () => 0
    };
    return sortFunction[selectedSort](a, b);
  });

  resultDiv.innerHTML = "";
  for (const level of sortedLevels) {
    const levelDiv = createLevelItem(level);
    resultDiv.appendChild(levelDiv);
  }
}

// Event listener for sort dropdown change
sortDropdown.addEventListener("change", (event) => {
    selectedSort = event.target.value;
    const activeStar = document.querySelector(".stars button.active");
    const selectedStar = starData.find((star) => star.id === activeStar.id);
    sortLevels(selectedStar);
});

// Event listener for star buttons
stars.forEach((starButton) => {
  starButton.addEventListener("click", () => {
    stars.forEach((s) => s.classList.remove("active"));
    starButton.classList.add("active");
    const selectedStar = starData.find((star) => star.id === starButton.id);

    if (selectedStar) {
      sortLevels(selectedStar);
    }
  });
});

// Random background image
function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    window.onload = function() {
      var randomNumber = getRandomInt(1, 182);
      document.body.style.backgroundImage = "url('backgrounds/background (" + randomNumber + ").png')";
    };
